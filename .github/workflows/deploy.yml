name: Deploy to Server

on:
	push:
		branches:
			- develop

jobs:
	deploy:
		runs-on: ubuntu-latest

		steps:
		  - name: Checkout code
			uses: actions/checkout@v3

		  - name: Setup SSH
			uses: webfactory/ssh-agent@v0.8.0
			with:
			ssh-private-key: ${{ secrets.SSH_PRIVATE_KEY }}

		  - name: Deploy via SSH
			run: |
				ssh -o StrictHostKeyChecking=no your_user@your_server_ip << 'EOF'
					cd /var/www/code/

					echo "Pulling latest code..."
					git pull origin develop

					echo "Installing dependencies..."
					npm install  # hoặc yarn install

					echo "Building app..."
					npm run build  # hoặc yarn build

					echo "Restarting service..."
					systemctl restart swoole-server.serivce

					echo "✅ Deployment completed"
				EOF
